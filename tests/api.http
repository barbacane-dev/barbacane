### Barbacane API Test Scenarios
### Each section has its own startup command.
### Tip: You can run individual requests from VS Code with the REST Client extension.

@baseUrl = http://localhost:8080

### ================================================================
### Validation & CRUD (validation.yaml)
### ================================================================
### Setup:
###   cargo build
###   ./target/debug/barbacane compile --spec tests/fixtures/validation.yaml -m tests/fixtures/barbacane.yaml -o /tmp/test.bca
###   ./target/debug/barbacane serve --artifact /tmp/test.bca --dev

### ================================
### Health & Internal Endpoints
### ================================

### Health check (200)
GET {{baseUrl}}/__barbacane/health

###

### OpenAPI specs index
GET {{baseUrl}}/__barbacane/openapi

###

### ================================
### Request Body Validation
### ================================

### Missing required body (400)
POST {{baseUrl}}/users
Content-Type: application/json

###

### Missing required field 'name' (400)
POST {{baseUrl}}/users
Content-Type: application/json

{"email": "test@example.com"}

###

### Valid request body (201)
POST {{baseUrl}}/users
Content-Type: application/json

{"name": "Test User", "email": "test@example.com"}

###

### Valid request with all fields (201)
POST {{baseUrl}}/users
Content-Type: application/json

{"name": "Test User", "email": "test@example.com", "age": 25}

###

### Wrong content type (400)
POST {{baseUrl}}/users
Content-Type: text/plain

name=Test

###

### Invalid JSON syntax (400)
POST {{baseUrl}}/users
Content-Type: application/json

{invalid json}

###

### Wrong type for field (400)
POST {{baseUrl}}/users
Content-Type: application/json

{"name": 123, "email": "test@example.com"}

###

### ================================
### Header & Query Validation
### ================================

### Missing required X-Request-ID header (400)
PUT {{baseUrl}}/users/123
Content-Type: application/json

{"name": "Updated"}

###

### With required X-Request-ID header (200)
PUT {{baseUrl}}/users/123
Content-Type: application/json
X-Request-ID: abc-123

{"name": "Updated"}

###

### Valid query params (200)
GET {{baseUrl}}/users?page=1&limit=10

###

### Invalid limit - over 100 (400)
GET {{baseUrl}}/users?limit=101

###

### ================================
### 404 & 405 Errors
### ================================

### Non-existent route (404)
GET {{baseUrl}}/nonexistent

###

### Method not allowed (405)
DELETE {{baseUrl}}/health

### ================================================================
### HTTP Upstream Proxy (proxy.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/proxy.yaml -m tests/fixtures/barbacane.yaml -o /tmp/proxy.bca
###   ./target/debug/barbacane serve --artifact /tmp/proxy.bca --dev --allow-plaintext-upstream

### Proxy GET - returns request info
GET {{baseUrl}}/proxy/get

###

### Proxy POST - echo JSON body
POST {{baseUrl}}/proxy/post
Content-Type: application/json

{"message": "Hello from Barbacane!", "timestamp": "2024-01-01T00:00:00Z"}

###

### Upstream returns 500
GET {{baseUrl}}/status/500

###

### Fast response (2s, within 5s timeout)
GET {{baseUrl}}/delay/2

###

### Slow response (6s, exceeds 5s timeout -> 504)
GET {{baseUrl}}/delay/6

### ================================================================
### Full CRUD (full-crud.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/full-crud.yaml -m tests/fixtures/barbacane.yaml -o /tmp/full-crud.bca
###   ./target/debug/barbacane serve --artifact /tmp/full-crud.bca --dev

### List users (200)
GET {{baseUrl}}/users

###

### List users with pagination (200)
GET {{baseUrl}}/users?limit=10&offset=0

###

### List users - invalid limit (400)
GET {{baseUrl}}/users?limit=200

###

### Create user - valid (201)
POST {{baseUrl}}/users
Content-Type: application/json

{"email": "test@example.com", "name": "Test User"}

###

### Create user - missing required name (400)
POST {{baseUrl}}/users
Content-Type: application/json

{"email": "test@example.com"}

###

### Create user - invalid email format (400)
POST {{baseUrl}}/users
Content-Type: application/json

{"email": "not-an-email", "name": "Test User"}

###

### Get user - valid UUID (200)
GET {{baseUrl}}/users/550e8400-e29b-41d4-a716-446655440000

###

### Get user - invalid UUID format (400)
GET {{baseUrl}}/users/not-a-uuid

###

### Update user (200)
PUT {{baseUrl}}/users/550e8400-e29b-41d4-a716-446655440000
Content-Type: application/json

{"name": "Updated Name", "email": "updated@example.com"}

###

### Delete user (204)
DELETE {{baseUrl}}/users/550e8400-e29b-41d4-a716-446655440000

###

### Get user orders with status filter (200)
GET {{baseUrl}}/users/550e8400-e29b-41d4-a716-446655440000/orders?status=pending

###

### Get user orders - invalid status enum (400)
GET {{baseUrl}}/users/550e8400-e29b-41d4-a716-446655440000/orders?status=invalid

### ================================================================
### Basic Auth (basic-auth.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/basic-auth.yaml -m tests/fixtures/barbacane.yaml -o /tmp/basic-auth.bca
###   ./target/debug/barbacane serve --artifact /tmp/basic-auth.bca --dev
###
### Credentials: admin/secret123 (roles: admin,read,write), reader/readonly456 (roles: read)

### Valid admin credentials (200)
# Check response headers: x-auth-consumer, x-auth-consumer-groups, x-auth-user, x-auth-roles
GET {{baseUrl}}/protected
Authorization: Basic YWRtaW46c2VjcmV0MTIz

###

### Valid reader credentials (200)
# Reader has no roles, so x-auth-consumer-groups should be absent
GET {{baseUrl}}/protected
Authorization: Basic cmVhZGVyOnJlYWRvbmx5NDU2

###

### Missing Authorization header (401)
# Check: WWW-Authenticate header with realm="test-api"
GET {{baseUrl}}/protected

###

### Invalid password (401)
GET {{baseUrl}}/protected
Authorization: Basic YWRtaW46d3JvbmdwYXNz

###

### Unknown user (401)
GET {{baseUrl}}/protected
Authorization: Basic dW5rbm93bjphbnl0aGluZw==

###

### Malformed Authorization header (401)
GET {{baseUrl}}/protected
Authorization: Basic !!!invalid-base64!!!

###

### Public endpoint - no auth required (200)
GET {{baseUrl}}/public

### ================================================================
### JWT Auth (jwt-auth.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/jwt-auth.yaml -m tests/fixtures/barbacane.yaml -o /tmp/jwt-auth.bca
###   ./target/debug/barbacane serve --artifact /tmp/jwt-auth.bca --dev
###
### Uses skip_signature_validation for testing with unsigned tokens.
### Token format: base64url(header).base64url(claims).sig

### Valid JWT with sub and iss (200)
# Header: {"alg":"RS256","typ":"JWT"}
# Claims: {"sub":"user123","iss":"test-issuer","aud":"test-audience","exp":4102444800}
# Check response headers: x-auth-consumer=user123, x-auth-sub=user123, x-auth-claims
GET {{baseUrl}}/protected
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMTIzIiwiaXNzIjoidGVzdC1pc3N1ZXIiLCJhdWQiOiJ0ZXN0LWF1ZGllbmNlIiwiZXhwIjo0MTAyNDQ0ODAwfQ.sig

###

### Missing Authorization header (401)
GET {{baseUrl}}/protected

###

### Expired JWT token (401)
# Header: {"alg":"RS256","typ":"JWT"}
# Claims: {"sub":"user123","iss":"test-issuer","exp":1000000000}
GET {{baseUrl}}/protected
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMTIzIiwiaXNzIjoidGVzdC1pc3N1ZXIiLCJleHAiOjEwMDAwMDAwMDB9.sig

###

### Wrong issuer (401)
# Claims: {"sub":"user123","iss":"wrong-issuer","exp":4102444800}
GET {{baseUrl}}/protected
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMTIzIiwiaXNzIjoid3JvbmctaXNzdWVyIiwiZXhwIjo0MTAyNDQ0ODAwfQ.sig

###

### Malformed token - only 2 parts (401)
GET {{baseUrl}}/protected
Authorization: Bearer header.payload

###

### Non-Bearer scheme (401)
GET {{baseUrl}}/protected
Authorization: Basic dXNlcjpwYXNz

###

### Public endpoint - no auth required (200)
GET {{baseUrl}}/public

### ================================================================
### API Key Auth (apikey-auth.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/apikey-auth.yaml -m tests/fixtures/barbacane.yaml -o /tmp/apikey-auth.bca
###   ./target/debug/barbacane serve --artifact /tmp/apikey-auth.bca --dev
###
### Keys: test-key-123 (read,write), readonly-key-456 (read), query-key-789 (query param)

### Valid API key in header (200)
# Check response headers: x-auth-consumer=key1, x-auth-consumer-groups=read,write
GET {{baseUrl}}/protected
X-API-Key: test-key-123

###

### Read-only API key (200)
# Check: x-auth-consumer-groups=read
GET {{baseUrl}}/protected
X-API-Key: readonly-key-456

###

### Missing API key (401)
GET {{baseUrl}}/protected

###

### Invalid API key (401)
GET {{baseUrl}}/protected
X-API-Key: nonexistent-key

###

### API key via query param (200)
GET {{baseUrl}}/query-auth?api_key=query-key-789

###

### Query param - missing key (401)
GET {{baseUrl}}/query-auth

###

### Public endpoint - no auth required (200)
GET {{baseUrl}}/public

### ================================================================
### ACL - Access Control Lists (acl.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/acl.yaml -m tests/fixtures/barbacane.yaml -o /tmp/acl.bca
###   ./target/debug/barbacane serve --artifact /tmp/acl.bca --dev
###
### Users (basic-auth credentials):
###   admin/admin123    -> roles: admin, editor
###   editor/editor123  -> roles: editor
###   viewer/viewer123  -> roles: viewer
###   banned_user/banned123 -> roles: viewer, banned

### ================================
### /admin-only (allow: [admin])
### ================================

### Admin allowed (200)
GET {{baseUrl}}/admin-only
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### Editor denied (403) - not in admin group
GET {{baseUrl}}/admin-only
Authorization: Basic ZWRpdG9yOmVkaXRvcjEyMw==

###

### Viewer denied (403)
GET {{baseUrl}}/admin-only
Authorization: Basic dmlld2VyOnZpZXdlcjEyMw==

###

### No auth (401) - basic-auth rejects before ACL
GET {{baseUrl}}/admin-only

###

### ================================
### /editors (allow: [admin, editor])
### ================================

### Admin allowed (200)
GET {{baseUrl}}/editors
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### Editor allowed (200)
GET {{baseUrl}}/editors
Authorization: Basic ZWRpdG9yOmVkaXRvcjEyMw==

###

### Viewer denied (403)
GET {{baseUrl}}/editors
Authorization: Basic dmlld2VyOnZpZXdlcjEyMw==

###

### ================================
### /deny-banned (deny: [banned])
### ================================

### Banned user denied (403) - has "banned" group
GET {{baseUrl}}/deny-banned
Authorization: Basic YmFubmVkX3VzZXI6YmFubmVkMTIz

###

### Editor allowed (200) - not in banned group
GET {{baseUrl}}/deny-banned
Authorization: Basic ZWRpdG9yOmVkaXRvcjEyMw==

###

### Admin allowed (200)
GET {{baseUrl}}/deny-banned
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### ================================
### /consumer-allow (allow_consumers: [admin], allow: [_restricted])
### ================================

### Admin consumer allowed (200) - bypass via allow_consumers
GET {{baseUrl}}/consumer-allow
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### Editor consumer denied (403) - not in allow_consumers, no matching group
GET {{baseUrl}}/consumer-allow
Authorization: Basic ZWRpdG9yOmVkaXRvcjEyMw==

###

### ================================
### /premium (allow: [premium], consumer_groups: {viewer: [premium]})
### ================================

### Viewer gets premium via static mapping (200)
GET {{baseUrl}}/premium
Authorization: Basic dmlld2VyOnZpZXdlcjEyMw==

###

### Admin denied (403) - no premium group
GET {{baseUrl}}/premium
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### ================================
### /public (no auth, no ACL)
### ================================

### Public access (200)
GET {{baseUrl}}/public

### ================================================================
### OPA Authorization (opa-authz.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/opa-authz.yaml -m tests/fixtures/barbacane.yaml -o /tmp/opa-authz.bca
###   ./target/debug/barbacane serve --artifact /tmp/opa-authz.bca --dev
###
### NOTE: The test fixture uses an unreachable OPA URL (127.0.0.1:19999).
### Without a running OPA server, all protected endpoints return 503.
### To test allow/deny decisions, run OPA locally:
###   docker run -p 8181:8181 openpolicyagent/opa:latest run --server
### and update opa_url in the fixture to http://localhost:8181/v1/data/authz/allow

### ================================
### /opa-protected (OPA only, unreachable → 503)
### ================================

### OPA unreachable - returns 503 (Service Unavailable)
# Check: problem+json body with type urn:barbacane:error:opa-unavailable
GET {{baseUrl}}/opa-protected

###

### ================================
### /opa-with-auth (basic-auth + OPA chain)
### ================================
### Users: admin/admin123, viewer/viewer123

### Admin credentials + OPA unreachable (503)
# basic-auth passes, OPA call fails
GET {{baseUrl}}/opa-with-auth
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### Viewer credentials + OPA unreachable (503)
GET {{baseUrl}}/opa-with-auth
Authorization: Basic dmlld2VyOnZpZXdlcjEyMw==

###

### Missing auth - basic-auth rejects before OPA (401)
GET {{baseUrl}}/opa-with-auth

###

### ================================
### /public (no middleware)
### ================================

### Public access bypasses OPA (200)
GET {{baseUrl}}/public

### ================================================================
### CEL Policy Evaluation (cel.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/cel.yaml -m tests/fixtures/barbacane.yaml -o /tmp/cel.bca
###   ./target/debug/barbacane serve --artifact /tmp/cel.bca --dev
###
### Inline CEL expressions for policy-based access control.
### No external service needed — evaluated in-process.

### ================================
### /cel-method-check (expression: "request.method == 'GET'")
### ================================

### GET allowed by CEL expression (200)
GET {{baseUrl}}/cel-method-check

###

### POST denied by CEL expression (403)
# Check: problem+json body with type urn:barbacane:error:cel-denied
POST {{baseUrl}}/cel-method-check
Content-Type: application/json

{"data": "test"}

###

### ================================
### /cel-with-auth (basic-auth + CEL: "request.consumer == 'admin'")
### ================================
### Users: admin/admin123, viewer/viewer123

### Admin allowed by consumer check (200)
# basic-auth sets x-auth-consumer=admin, CEL checks it
GET {{baseUrl}}/cel-with-auth
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### Viewer denied by consumer check (403)
# basic-auth sets x-auth-consumer=viewer, CEL denies
GET {{baseUrl}}/cel-with-auth
Authorization: Basic dmlld2VyOnZpZXdlcjEyMw==

###

### Missing auth (401) - basic-auth rejects before CEL
GET {{baseUrl}}/cel-with-auth

###

### ================================
### /public (no middleware)
### ================================

### Public access (200)
GET {{baseUrl}}/public

### ================================================================
### Rate Limiting (rate-limit.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/rate-limit.yaml -m tests/fixtures/barbacane.yaml -o /tmp/rate-limit.bca
###   ./target/debug/barbacane serve --artifact /tmp/rate-limit.bca --dev
###
### Quota: 3 requests / 60 seconds, keyed by X-Client-Id header

### Request 1 of 3 (200)
# Check headers: X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset
GET {{baseUrl}}/limited
X-Client-Id: tester-1

###

### Request 2 of 3 (200)
GET {{baseUrl}}/limited
X-Client-Id: tester-1

###

### Request 3 of 3 (200)
GET {{baseUrl}}/limited
X-Client-Id: tester-1

###

### Request 4 - over quota (429)
# Check: Retry-After header
GET {{baseUrl}}/limited
X-Client-Id: tester-1

###

### Different client - separate quota (200)
GET {{baseUrl}}/limited
X-Client-Id: tester-2

###

### Unlimited endpoint (200)
GET {{baseUrl}}/unlimited

### ================================================================
### IP Restriction (ip-restriction.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/ip-restriction.yaml -m tests/fixtures/barbacane.yaml -o /tmp/ip-restriction.bca
###   ./target/debug/barbacane serve --artifact /tmp/ip-restriction.bca --dev

### Localhost allowed by allowlist (200)
GET {{baseUrl}}/allowlist

###

### Denied via X-Forwarded-For spoofing (403)
# Simulates request from a non-allowed IP
GET {{baseUrl}}/allowlist
X-Forwarded-For: 203.0.113.50

###

### Public endpoint - no restriction (200)
GET {{baseUrl}}/public

### ================================================================
### CORS (cors.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/cors.yaml -m tests/fixtures/barbacane.yaml -o /tmp/cors.bca
###   ./target/debug/barbacane serve --artifact /tmp/cors.bca --dev

### ================================
### Preflight Requests (OPTIONS)
### ================================

### Preflight - any origin allowed (200)
# Check: Access-Control-Allow-Origin: *, Access-Control-Allow-Methods, Access-Control-Max-Age
OPTIONS {{baseUrl}}/any-origin
Origin: https://any-site.com
Access-Control-Request-Method: GET

###

### Preflight - specific origin allowed (200)
# Check: Access-Control-Allow-Origin: https://example.com
OPTIONS {{baseUrl}}/specific-origin
Origin: https://example.com
Access-Control-Request-Method: GET

###

### Preflight - specific origin denied (403 or missing CORS headers)
OPTIONS {{baseUrl}}/specific-origin
Origin: https://evil.com
Access-Control-Request-Method: GET

###

### Preflight - with credentials (200)
# Check: Access-Control-Allow-Credentials: true
OPTIONS {{baseUrl}}/with-credentials
Origin: https://trusted.example.com
Access-Control-Request-Method: POST

###

### ================================
### Simple Requests
### ================================

### Simple GET with Origin (200)
# Check: Access-Control-Allow-Origin in response
GET {{baseUrl}}/any-origin
Origin: https://any-site.com

###

### GET without Origin - no CORS headers
GET {{baseUrl}}/any-origin

###

### No-CORS endpoint
GET {{baseUrl}}/no-cors

### ================================================================
### Correlation ID (correlation-id.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/correlation-id.yaml -m tests/fixtures/barbacane.yaml -o /tmp/correlation-id.bca
###   ./target/debug/barbacane serve --artifact /tmp/correlation-id.bca --dev

### Auto-generated correlation ID (200)
# Check response header: x-correlation-id (should be a UUID)
GET {{baseUrl}}/tracked

###

### Incoming correlation ID preserved (200)
# Check: response x-correlation-id matches the sent value
GET {{baseUrl}}/tracked
X-Correlation-Id: my-trace-abc-123

### ================================================================
### Request Size Limit (request-size-limit.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/request-size-limit.yaml -m tests/fixtures/barbacane.yaml -o /tmp/request-size-limit.bca
###   ./target/debug/barbacane serve --artifact /tmp/request-size-limit.bca --dev

### Small body within 100 byte limit (200)
POST {{baseUrl}}/limited
Content-Type: application/json

{"ok": true}

###

### Large body exceeding 100 byte limit (413)
POST {{baseUrl}}/limited
Content-Type: application/json

{"data": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"}

###

### Unlimited endpoint - large body accepted (200)
POST {{baseUrl}}/unlimited
Content-Type: application/json

{"data": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"}

### ================================================================
### Cache (cache.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/cache.yaml -m tests/fixtures/barbacane.yaml -o /tmp/cache.bca
###   ./target/debug/barbacane serve --artifact /tmp/cache.bca --dev

### First request - cache miss (200)
# Check response headers: X-Cache: MISS
GET {{baseUrl}}/cached

###

### Second request - cache hit (200)
# Check response headers: X-Cache: HIT
GET {{baseUrl}}/cached

###

### Vary by Accept-Language - English (200)
GET {{baseUrl}}/cached-with-vary
Accept-Language: en

###

### Vary by Accept-Language - French (200, different cache entry)
GET {{baseUrl}}/cached-with-vary
Accept-Language: fr

###

### POST not cached (200)
# POST requests bypass cache by default
POST {{baseUrl}}/post-not-cached
Content-Type: application/json

{"data": "test"}

###

### Uncached endpoint (200)
GET {{baseUrl}}/uncached

### ================================================================
### API Lifecycle / Deprecation (deprecated.yaml)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/deprecated.yaml -m tests/fixtures/barbacane.yaml -o /tmp/deprecated.bca
###   ./target/debug/barbacane serve --artifact /tmp/deprecated.bca --dev

### Current endpoint - no deprecation headers (200)
GET {{baseUrl}}/v2/users

###

### Deprecated endpoint (200)
# Check: Deprecation: true header
GET {{baseUrl}}/v1/users

###

### Deprecated with sunset date (200)
# Check: Deprecation: true AND Sunset headers
GET {{baseUrl}}/v1/users/123

###

### Legacy endpoint with far-future sunset (200)
# Check: Sunset: 2030-... header
GET {{baseUrl}}/legacy/status

### ================================================================
### Multi-Spec (multi-spec/)
### ================================================================
### Setup:
###   ./target/debug/barbacane compile --spec tests/fixtures/multi-spec/users.yaml --spec tests/fixtures/multi-spec/orders.yaml -m tests/fixtures/multi-spec/barbacane.yaml -o /tmp/multi.bca
###   ./target/debug/barbacane serve --artifact /tmp/multi.bca --dev

### Users service - list users (200)
GET {{baseUrl}}/users

###

### Users service - create user (201)
POST {{baseUrl}}/users
Content-Type: application/json

{"name": "Alice", "email": "alice@example.com"}

###

### Orders service - list orders (200)
GET {{baseUrl}}/orders

###

### Orders service - create order (201)
POST {{baseUrl}}/orders
Content-Type: application/json

{
  "userId": "user-123",
  "items": [
    {"productId": "prod-1", "quantity": 2},
    {"productId": "prod-2", "quantity": 1}
  ]
}

###

### Combined health check
GET {{baseUrl}}/__barbacane/health
